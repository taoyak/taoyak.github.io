<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Flat life, is a happy."><title>zabbix监控软件相关知识简单介绍 | Yak's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">zabbix监控软件相关知识简单介绍</h1><a id="logo" href="/.">Yak's blog</a><p class="description">taoyak</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">zabbix监控软件相关知识简单介绍</h1><div class="post-meta">Mar 6, 2017<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><ol>
<li>什么是zabbix?</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">概述</div><div class="line">Zabbix由Alexei Vladishev创建，目前由Zabbix SIA积极开发和支持。</div><div class="line">Zabbix是一个企业级开源的分布式监控解决方案。</div><div class="line">Zabbix是监控网络的众多参数以及服务器的健康和完整性的软件。 Zabbix使用灵活的通知机制，允许用户为几乎任何事件配置基于电子邮件的警报。这允许对服务器问题的快速反应。基于存储的数据，Zabbix提供卓越的报告和数据可视化功能。这使得Zabbix成为容量规划的理想选择。</div><div class="line">Zabbix支持轮询和陷印。所有Zabbix报告和统计信息以及配置参数都通过基于Web的前端访问。基于Web的前端可确保从任何位置评估网络的状态和服务器的运行状况。正确配置后，Zabbix可以在监控IT基础架构中发挥重要作用。这对于具有少量服务器的小型组织和具有大量服务器的大型公司同样如此。</div><div class="line">Zabbix是免费的。 Zabbix是在GPL通用公共许可证版本2下编写和分发的。这意味着其源代码是免费分发的并可供一般公众使用。</div><div class="line">商业支持由Zabbix公司提供。</div></pre></td></tr></table></figure>
<p>2.Zabbix功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line">概述</div><div class="line">Zabbix是一种高度集成的网络监控解决方案，在单个封装中提供多种功能。</div><div class="line"></div><div class="line">数据收集</div><div class="line">	可用性和性能检查</div><div class="line">	支持SNMP（陷阱和轮询），IPMI，JMX，VMware监控</div><div class="line">	自定义检查</div><div class="line">	以定制间隔收集所需数据</div><div class="line">	由服务器/代理和代理执行</div><div class="line"></div><div class="line">灵活的阈值定义</div><div class="line">	您可以定义非常灵活的问题阈值，称为触发器，引用来自后端数据库的值</div><div class="line"></div><div class="line">高度可配置的警报</div><div class="line">	可以为升级调度，收件人，媒体类型自定义发送通知</div><div class="line">	可以使用宏变量使通知变得有意义和有用</div><div class="line">	自动操作包括远程命令</div><div class="line"></div><div class="line">实时图形</div><div class="line">	使用内置的图形功能立即绘制监视项目</div><div class="line"></div><div class="line">Web监视功能</div><div class="line">	Zabbix可以按照在网站上模拟鼠标点击的路径，检查功能和响应时间</div><div class="line"></div><div class="line">广泛的可视化选项</div><div class="line">	能够创建可将多个项目合并为单个视图的自定义图形</div><div class="line">	网络地图</div><div class="line">	自定义屏幕和幻灯片，用于仪表板样式概述</div><div class="line">	报告</div><div class="line">	高级（业务）视图的受监视资源</div><div class="line"></div><div class="line">历史数据存储</div><div class="line">	数据存储在数据库中</div><div class="line">	可配置历史</div><div class="line">	内置内务程序</div><div class="line"></div><div class="line">配置方便</div><div class="line">	将受监控设备添加为主机</div><div class="line">	主机被拾取用于监视，一次在数据库中</div><div class="line">	将模板应用于受监控设备</div><div class="line"></div><div class="line">使用模板</div><div class="line">	在模板中分组检查</div><div class="line">	模板可以继承其他模板</div><div class="line"></div><div class="line">网络发现</div><div class="line">	自动发现网络设备</div><div class="line">	代理自动注册</div><div class="line">	发现文件系统，网络接口和SNMP OID</div><div class="line"></div><div class="line">快速的web界面</div><div class="line">	PHP中的基于Web的前端</div><div class="line">	可从任何地方访问</div><div class="line">	你可以点击你的方式</div><div class="line">	审计日志</div><div class="line"></div><div class="line">Zabbix API</div><div class="line">	Zabbix API为Zabbix 提供可编程接口，用于大规模操作，第三方软件集成和其他目的。</div><div class="line"></div><div class="line">权限系统</div><div class="line">	安全用户认证</div><div class="line">	某些用户可以限制到某些视图</div><div class="line"></div><div class="line">全功能和易扩展的代理</div><div class="line">	部署在监控目标上</div><div class="line">	可以部署在Linux和Windows上</div><div class="line"></div><div class="line">二进制守护进程</div><div class="line">	写在C，性能和小内存占用</div><div class="line">	轻松便携</div><div class="line"></div><div class="line">准备复杂的环境</div><div class="line">	通过使用Zabbix代理，使远程监控变得容易</div></pre></td></tr></table></figure>
<p>3.可以监控的对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">设备/软件</div><div class="line">			设备：服务器、交换机、路由器、IO系统</div><div class="line">			软件：OS、网络、应用程序</div><div class="line"></div><div class="line">偶发现故障：</div><div class="line">			主机down机，服务不可用、主机不可达</div><div class="line"></div><div class="line">严重故障：</div><div class="line">			主机性能指标</div><div class="line"></div><div class="line">趋势：</div><div class="line">			时间序列数据</div><div class="line"></div><div class="line">web：</div><div class="line">			api、页面状态，下载速度，页面打开时间，</div><div class="line">			可以配合脚本，监控一切能监控的状态</div></pre></td></tr></table></figure></p>
<p>4.zabbix发展：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">第一版本：2012年07月31日，ZABBIX 2.0.2 正式版发布。</div><div class="line">现在官网最新版本3.4,不过现在生产环境主流应用还是3.0和3.2版本。</div></pre></td></tr></table></figure></p>
<p>5.ZABBIX由几个主要的软件组件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">server:</div><div class="line">			ZABBIX服务器是核心部件到代理报告的可用性和完整性信息和统计数据。服务器在中央存储库中，所有的配置，统计数据和运营数据存储。</div><div class="line">Database storage:</div><div class="line">			所有配置信息以及由的zabbix收集的数据被存储在数据库中。</div><div class="line">Web interface：</div><div class="line">			Zabbix web interface must run on the same physical machine if SQLite is used.</div><div class="line">Proxy</div><div class="line">			zabbix代理可以收集代表zabbix服务器的性能和可用性数据。代理服务器是部署zabbix的可选部分;但是，它可能是非常有益的分发单个zabbix服务器的负荷。</div><div class="line">Agent</div><div class="line">			zabbix agents部署在监测目标，以积极监测当地的资源和应用程序，并收集到的数据报告给zabbix服务器。</div><div class="line">Data flow</div><div class="line">			看看内zabbix整个数据流是非常重要的。为了创建一个收集项目数据，你必须首先创建一个主机。移动到zabbix光谱的另一端，你必须首先要创建触发器的项目。你必须有一个触发器来创建一个动作。因此，如果您希望收到你的CPU加载过高的服务器X，你必须首先创建服务器X监测其CPU主机条目后面跟着一个项目警报，然后触发其激活，如果CPU太高，其次由向您发送电子邮件的操作。虽然这可能看起来很多的步骤，使用模板的它真的不是。然而，由于这样的设计，可以创建一个非常灵活的设置。</div></pre></td></tr></table></figure></p>
<p>6.zabbix术语定义<br>(1)术语<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">主机(host)：</div><div class="line">	-要监控的网络设备，可由IP或DNS名称指定；</div><div class="line">主机组(host group)：</div><div class="line">	- 主机的逻辑容器，它可以含有主机和模板,但同一个组内的主机和模板不能互</div><div class="line">	相链接;主机组通常在给用户或用户组指派监控权限时使用；</div><div class="line">监控项(item)：</div><div class="line">	- 一个特定监控指标的相关的数据,这些数据来自于被监控对象，item是zabbix</div><div class="line">	进行数据收集的核心，没有item，将没有数据，相对某监控对象来说，每个item</div><div class="line">	都由“key”进行标识；</div><div class="line">触发器(trigger):</div><div class="line">	- 定义一个问题阈值的逻辑表达式，用于“评估”收到的数据当接收到的数据</div><div class="line">	高于阈值，触发器从“ok”进入一个“problem”状态,当接收到的数据低于阈值时，</div><div class="line">	触发停留在/返回一个“ok”状态。</div><div class="line">事件(event):</div><div class="line">	- 即发生的一个值的关注的事情，比如触发器的状态转换，新的agent或重新上</div><div class="line">	线的agent的自动注册等；</div><div class="line">行动(action):</div><div class="line">	- 对于特定事件事先定义的处理方法，通过包含操作(如发通知)和条件(何时执行)。</div><div class="line">	一个动作由操作（如发送通知）和条件（当操作被执行）</div><div class="line">报警升级(escalation):</div><div class="line">	- 发送警报或执行远程命令的自定义方案，如每隔5分钟发送一次警报，共发送5次等；</div><div class="line">media(媒体)</div><div class="line">	- 发送通知的手段;传递通道，发送告警的几种方式：email、script、sms(短信)、jabber	(php开发的一款即时通讯软件)、商业EZ短信</div><div class="line">notification(通告)</div><div class="line">	- 通过选定的媒体频道发送给用户的一些事件的消息</div><div class="line">remote command(远程命令)</div><div class="line">	- 在某些情况下，一个预先定义的命令，在监视主机上处于某特定条件下自动执行；</div><div class="line">template(模板)</div><div class="line">	- 用于快速定义被监控主机的预设条目集合，通常包含了item,trigger,graph,screen、</div><div class="line">	application以及low-level discovery rule;模板可以直接连接至单个主机；</div><div class="line">应用(application)</div><div class="line">	一组item的集合；</div><div class="line">web场景(web scennario):</div><div class="line">	- 用于检测web站点可用性的一个或多个http请求；</div><div class="line">前端(frontend):</div><div class="line">	- 提供zabbix web接口；</div><div class="line">Zabbix API</div><div class="line">	- Zabbix API允许你使用JSON RPC协议的创建、更新和获取对象（如主机，Zabbix项目，图表和其他）或执行任何其他自定义任务</div><div class="line">Zabbix server</div><div class="line">	- Zabbix软件执行监控中心的过程中，与Zabbix代理和代理，计算触发，发送通知数据的中央存储库；</div><div class="line">zabbix agent</div><div class="line">	- 部署在监测目标的过程中，积极监测当地资源和应用</div><div class="line">zabbix proxy</div><div class="line">	- 可以收集代表zabbix服务器的数据，取一些处理负载关闭服务器的处理</div></pre></td></tr></table></figure></p>
<p>(2)agent两种模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">被动和主动检查</div><div class="line">简单来说：</div><div class="line">主动：agent请求server获取主动的监控项列表，并主动将监控项内需要检测的数据提交给server/proxy</div><div class="line">主动模式流程:</div><div class="line">	主动模式一定要记得设置ServerActive=ServerIP</div><div class="line">	Agent向Server建立一个TCP连接</div><div class="line">	Agent请求需要检测的数据列表</div><div class="line">	Server响应Agent，发送一个Items列表</div><div class="line">	Agent允许响应</div><div class="line">	TCP连接完成本次会话关闭</div><div class="line">	Agent开始周期性地收集数据.</div><div class="line"></div><div class="line">被动：server向agent请求获取监控项的数据，agent返回数据。</div><div class="line">被动模式一定要记得设置Server ＝ ServerIP</div><div class="line">被动模式工作流程:</div><div class="line">	Server 打开一个TCP连接</div><div class="line">	Server发送一个key 为agent.ping</div><div class="line">	Agent接受这个请求，然后响应&lt; HEADER &gt;&lt; DATALEN &gt;</div><div class="line">	Server对接受到的数据进行处理</div><div class="line">	TCP连接关闭</div></pre></td></tr></table></figure>
<p>(3)proxy:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Zabbix代理是一个过程，可以收集从一个或多个监测设备的监测数据，并将信息发送给Zabbix服务器，基本上是在代表服务器。所有收集的数据的本地缓冲然后转到Zabbix服务器代理属于。</div><div class="line">部署一个代理是可选的，但可能是一个单一的Zabbix服务器的负载分配非常有限。如果只代理收集数据，服务器上的处理就变少了，性能会得到提升。</div></pre></td></tr></table></figure>
<p>(4)java gateway<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">监控java应用jmx</div></pre></td></tr></table></figure></p>
<p>(5)zabbix sender    (被动监控模式)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">zabbix_sender是一个命令行工具，可以用来发送Zabbix服务器处理性能数据。该工具通常用于长时间运行的用户脚本，</div><div class="line">用于定期发送可用性和性能数据。例子：http://www.fyluo.com/?post=126</div></pre></td></tr></table></figure></p>
<p>(6)zabbix get<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Zabbix得到的是一个命令行工具，可用于交流和Zabbix代理代理检索所需的信息。</div><div class="line">它通常用于Zabbix代理的故障排除。</div><div class="line">参数说明：</div><div class="line">-s --host： 指定客户端主机名或者IP</div><div class="line">-p --port：客户端端口，默认10050</div><div class="line">-I --source-address：指定源IP，写上zabbix server的ip地址即可，一般留空，服务器如果有多ip的时候，你指定一个。</div><div class="line">-k --key：你想获取的key</div><div class="line">比如监控cpu15分钟内的负载：</div><div class="line">[root@ip-172-31-1-181 ~]# zabbix_get -s 127.0.0.1 -p 10050 -k &quot;system.cpu.load[all,avg15]&quot;</div><div class="line">0.050000</div></pre></td></tr></table></figure></p>
<p>7.zabbix产生的数据主要由四部分组成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">配置数据：</div><div class="line">历史数据：</div><div class="line">历史趋势数据:</div><div class="line">时间数据：</div></pre></td></tr></table></figure>
<ol>
<li>zabbix3.0 install:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- 编译安装：</div><div class="line">	https://www.zabbix.com/documentation/3.0/manual/installation/install#from_distribution_packages</div><div class="line">- yum安装：</div><div class="line">	https://www.zabbix.com/documentation/3.0/manual/installation/install_from_packages</div><div class="line">	一直坚持yum安装，原则如下：</div><div class="line">		1. 公共约定优先，方便运维</div><div class="line">		2. 方便编写自动化部署脚本</div><div class="line">		3. 应用升级方便</div></pre></td></tr></table></figure>
</li>
</ol>
<p>9.zabbix quickstart(快速入门)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div></pre></td><td class="code"><pre><div class="line">1.login and configuring user</div><div class="line">2.new host</div><div class="line">3.new item(新项目)</div><div class="line">	监控项(item)是zabbix服务器用于监控一个特定对象上的一个特定指标，并负载针对其收集相关</div><div class="line">	的监控数据</div><div class="line">		比如CPU每分钟的平均负载可以是一个item,每五分钟的平均负载是一个item,某特定网络接口接</div><div class="line">		收报文的速率又是一个item等。</div><div class="line">	每一个item都拥有相应的“类型(Type)”</div><div class="line">		例如：“zabbix agent”、“snmp”、“External check”、&quot;IPMI agent&quot;、&quot;ssh agent&quot;、“jmx agent”等</div><div class="line">		zabbix服务器会使用相应类型的协议或机制同被监控端通信</div><div class="line">	item key</div><div class="line">		每一个item都有其专用的“key”</div><div class="line">		zabbix服务器在与被监控端通信时就使用相应的协议或机制去询问被监控端这个key的值，</div><div class="line">		被监控端则调用与此key对应的监控脚本获取数据并返回给服务器端</div><div class="line">		key的命名只能使用“0-9a-zA-Z_.”(引号中的内容)等字符，且可以接受参数，其命令习惯</div><div class="line">		如system.cpu.load[&lt;cpu&gt;,&lt;mode&gt;]，其中，中括号中的内容为参数，且分别可以按次序</div><div class="line">		使用$1,$2、...进行引用，此实例中仅有两个参数</div><div class="line">			若要使用不定数目的参数，则可以使用*表示</div><div class="line">			zabbix有许多预定义的key,详细信息的获取地址：</div><div class="line"></div><div class="line">			对于每一个item,zabbix服务器还定义了怎么存储这个item的数据以数据采集的频率</div><div class="line">			及历史数据的保存时长等</div><div class="line">			多个item还可归类为一个由application定义的逻辑组</div><div class="line"></div><div class="line">			name:item的名字，可以使用宏变量：$1, $2…$9，这9个参数对应item key的参数位置。</div><div class="line">			type:zabbix server服务器用什么机制于被监控客户端通信，item类型（常见agent、SNMP、agent（active）等），控制方式不同，key的配置也不同。</div><div class="line">			key:监控项item的key.点击select菜单能查找出可以支持的Item keys，自定义的key不能通过菜单查找出来，需手工输入。</div><div class="line">			host interface:主机的接口，在配置了多种监控方式或多个IP监控的时候，可以基于主机接口来选择。</div><div class="line"></div><div class="line">			type of infrmation:(选择哪一个，跟采样的数据结果有关系)</div><div class="line">				数据中进行类型转换之后存入数据库中，</div><div class="line">				Numeric (unsigned) – 64bit无符号的整数；如果是整数，就现则无符号的整数</div><div class="line">				Numeric (float) – 浮点数类型;</div><div class="line">				Character – 字符串，最长255字节Log – 日志文件. key必须为log[];</div><div class="line">				Text – 大小无限制的文本；</div><div class="line">			date type:</div><div class="line">			数据类型用于存储items中key所获取的数值，用于存储在不同的表中，定义获取到整数数据的数据类型Boolean – 数据为0或者1.</div><div class="line">			’true’表示1，’false’为0，不区分大小写。如下为True和False的定义：TRUE – true, t, yes, y, on, up, running, enabled,</div><div class="line">			availableFALSE – false, f, no, n, off, down, unused, disabled, unavailable任何非0数字都被认为是TRUE，0被定义为</div><div class="line">			FALSE.负数呢?Octal – 八进制Decimal – 十进制Hexadecimal – 十六进制zabbix将会自动把他们转为数字</div><div class="line">			units:单位，如果定义为bps,超过1000，会生成1kb,超过1000000，会生成1Mbps</div><div class="line">			use custom multiplier:</div><div class="line">			update interval(in sec):采样时间间隔，可以自定义,</div><div class="line">			fiexble intervals:选择哪个时间段需要监控</div><div class="line">			history storage period(in days):保存历史数据的时间，</div><div class="line">			Trend storage period(in days):保留历史趋势数据，可以长一点儿(比历史数据占用空间小)</div><div class="line">				历史数据：采样生成的数据</div><div class="line">				历史趋势数据：每小时的最大值，最小值，平均值，统计</div><div class="line">			Store value：</div><div class="line">				As is:不做任何处理，是啥就存啥</div><div class="line">				Delta(speed per second):(value - pre_value)/(time - pre_time)</div><div class="line">				例如网卡流量，每次获取到得都是当前网卡总流量。比如第一次给的值是0字节</div><div class="line">				（UNIX时间为1），第二获取到得是3000字节（UNIX时间为31），</div><div class="line">				那么套用公式（3000-0）/（31-30），可以得出数据是100字节/秒</div><div class="line">				备注：如果当前获取到的值比上一个值更小，那么zabbix会忽略这个值</div><div class="line">				10：12000，20:13000，</div><div class="line">				delta(simple change):(value - pre_value)</div><div class="line">			show value:</div><div class="line">				值映射，需要配置数字映射到字符的映射表。例如1=&gt;ttlsa.com访问正常。</div><div class="line">				如果key返回的数据为1，那么监控页面不会显示1，而是显示ttlsa.com访问正常。</div><div class="line">				key返回的数据只能为整数，并且不做任何修改保存到数据库中。只有在显示的时候</div><div class="line">				才会根据映射表来展示相应的内容</div><div class="line">			new application：</div><div class="line">				指定一个新的应用</div><div class="line">			Populates host inventory field：</div><div class="line">				将item归属于哪个资产管理组中</div><div class="line">			Description：</div><div class="line">				监控项的描述</div><div class="line">			Enabled：</div><div class="line">				是否启用这个监控项</div><div class="line">	创建一个graph</div><div class="line">		name:图形名称</div><div class="line">		width:宽度</div><div class="line">		height:高度</div><div class="line">		show legend:</div><div class="line">		    Normal：线状图</div><div class="line">			stacked:堆叠图</div><div class="line">			pie:饼图</div><div class="line">			exploded:爆炸饼图</div><div class="line">		Show legend:</div><div class="line">			显示出数据指标是什么</div><div class="line">		Percentile line (left)</div><div class="line">			：左边坐标轴百分比</div><div class="line">		Percentile line (right)</div><div class="line">			：右边坐标轴百分比</div><div class="line">		Y axis MIN value:</div><div class="line">			Calculated：自动计算最小值</div><div class="line">			fixed:固定最小值</div><div class="line">			item:最后一次获取的为最小值</div><div class="line">		Y axis MAX value:</div><div class="line">			Calculated：自动计算最大值</div><div class="line">			fixed:固定最大值</div><div class="line">			item:最后一次获取的为最大值</div><div class="line">		item:添加定义好的监控项</div><div class="line"></div><div class="line">4 创建触发器(trigger)</div><div class="line">	”监控项“仅负责搜集数据，而通常收集数据的目的还包括在某指标对应的数据超出合理范围时</div><div class="line">	给相关人员发送告警信息，“触发器”正是用于为监控项所收集的数据定义阈值</div><div class="line">	每一个触发器仅能关联至一个监控项，但可以我一个监控项同时使用多个触发器</div><div class="line">		事实上，为一个监控项定义多个具有不同阈值的触发器，可以实现不同级别的报警功能</div><div class="line">	一个触发器由一个表达式构成，它定义了监控项所采取的数据的一个阈值</div><div class="line">	一旦某次采集的数据超出了此触发器定义的阈值，触发器状态将会转换为“problem”；而当采取</div><div class="line">	的数据再次回归至合理范围内时，其状态将重新返回到“ok”</div><div class="line">	触发器表达式高度灵活，可以为之创建出非常复杂的测试条件</div><div class="line">	基本的触发器表达式格式如下所示：</div><div class="line">		&#123;&lt;server&gt;:&lt;key&gt;.&lt;function&gt;(&lt;parameter&gt;)&#125;&lt;operator&gt;&lt;constant&gt;</div><div class="line">			server:主机名；</div><div class="line">			key:主机上关联的相应监控项的key;</div><div class="line">			function:评估采集到的数据是否在合理范围内时所使用的函数，其评估过程可以根据</div><div class="line">			采取的数据、当前时间及其它因素进行；</div><div class="line">			目前，触发器所支持的函数：avg、count、change、date、dayofweek、delta、diff、</div><div class="line">			iregexp、last、max、min、nodata、now、sum等</div><div class="line">			parameter:函数参数，大多数数值函数可以接受秒数为其参数，而如果在数值参数之前</div><div class="line">			使用&quot;#&quot;作为前缀，则表示为最近几次的取值，如sum(300)表示300秒内所有取值之和，</div><div class="line">			而sum(#10)则表示最近10次取值之和；</div><div class="line">			此外，avg、count、last、min和max还支持使用第二个参数，用于完成时间限定；例如，</div><div class="line">			max(1h,7d)将返回一周之前的最大值；</div><div class="line">		一个例子：</div><div class="line">			&#123;www.micous.com:system.cpu.load[all,avg1].last(0)&#125;&gt;3</div><div class="line">			表示主机www.micous.com上所有cpu的过去1分钟内的平均负载的最后一次取值大于3时将</div><div class="line">			http://www.ttlsa.com/zabbix/zabbix-trigger-expression/</div><div class="line">			触发状态变换</div><div class="line">			对last函数来说，last(0)相当于last(#1)</div><div class="line">		在一个网络中，主机的可用性之间可能存在依赖关系</div><div class="line">			例如,当某网关主机不可用时，其背后的所有主机都将无法正常访问</div><div class="line">			如果所有主机都配置了触发器并定义了相关的通知功能，相关人员将会接收到许多告警</div><div class="line">			信息，这既不利于快速定位问题，也会浪费资源</div><div class="line">			正确定义的触发器依赖关系可以避免类似情况的发生，它将使用通知机制仅发送最根本</div><div class="line">			问题相关的告警</div><div class="line">		注意：目前zabbix不能够直接定义主机间的依赖关系，其依赖关系仅能通过触发器来定义</div><div class="line">	触发器等级：</div><div class="line">		触发器等级用于表示事件的严重性</div><div class="line">		zabbix支持如下表示的等级：</div><div class="line">			not classified	unknow serverity	grey</div><div class="line">			information		for information purposess</div><div class="line">			warning</div><div class="line">			average</div><div class="line">			high</div><div class="line">			disaster</div><div class="line">	    name:trigger名字</div><div class="line">		Expression:条件</div><div class="line">			Expression constructor</div><div class="line">		问题升级：</div><div class="line">		描述：</div><div class="line">		URL：指定是从哪个triggerID发送的</div><div class="line">触发事件，执行报警：</div><div class="line">	默认三种：email、jabber、sms手机短信、外部其他商业短信报警</div><div class="line">email：</div><div class="line">	name:类型email</div><div class="line">	type：email</div><div class="line">	smtp server:mail.zabbix.example.cn</div><div class="line">	smtp helo:zabbix.example.cn</div><div class="line">	smtp email:zabbix@zabbix.example.cn</div><div class="line">发给哪个用户：</div><div class="line">	添加用户，添加发送到的邮箱地址，设置发送时间和报警级别。</div><div class="line">定义action:</div><div class="line"></div><div class="line">	action有两类：</div><div class="line">		send message</div><div class="line">		command</div><div class="line">一次监控的配置过程：host groups-host--&gt;application--&gt;item--&gt;trigger(一个item可以多个</div><div class="line">trigger)--&gt;action--&gt;(send message,command)</div><div class="line">	send message:</div><div class="line">		media type:</div><div class="line">		zabbix user:使用可用item</div><div class="line"></div><div class="line">模板：</div><div class="line">	创建zabbix模板</div><div class="line">		点击Configuration（配置） ---Templates（模板）---create template（创建模板），</div><div class="line">		Template name：模板名称，在嵌套模板中，都使用template name</div><div class="line">		Visible name ：显示的名称，template显示是visible name，方便识别</div><div class="line">		Groups Host/template ：当前模板归到哪个组</div><div class="line">		New group：创建一个新组，当前模板便会加入这个组，可以为空</div><div class="line">		Hosts/Templates：把模板链接到主机</div><div class="line">		描述：一些描述信息</div><div class="line">Linked templates：</div><div class="line">	需要嵌套的模板，输入关键词，然后选择你要的模板，最后点击add,</div><div class="line">	模板嵌套，是一个继承的关系。例如我们定义了一个基础模板，里面item有cpu、内存、硬盘、</div><div class="line">	网卡等等基本信息监控，我们有需要定义个MySQL与WEB监控模板，那么这两个模板分别嵌套这</div><div class="line">	个基础模板即可，而不需要重复定义监控项。</div><div class="line">	模板级宏变量，以后跟大家介绍一下。</div><div class="line">编辑zabbix模板</div><div class="line">	点击Configuration（配置） ---Templates（模板）---你需要编辑的模板，当前的底部要比创建模板要多几个按钮，</div><div class="line">	我们分别来讲下这下按钮都是做什么的</div><div class="line">	save：保存，没什么好说的</div><div class="line">	Clone：克隆模板，克隆一个与当前模板一模一样的模板，此时你只需要修改下模板名称，以及在其基础上做修改，</div><div class="line">	便能很快的完成一个模板</div><div class="line">	full clone：完全克隆，比clone多一点东西，例如screen</div><div class="line">	delete：删除模板，如果主机有嵌套当前模板，那么这些item依旧保留在主机上，主机不受影响</div><div class="line">	delete and clear：删除模板，如果主机有嵌套当前模板，那么这些item也被删除掉。</div><div class="line">	cancel：取消</div></pre></td></tr></table></figure></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://taoyak.com/2017/03/06/zabbix笔记之相关知识简单介绍/" data-id="cj5s45cg9000gpzfyvqztwlp1" class="article-share-link">分享到</a><div class="tags"><a href="/tags/zabbix/">zabbix</a></div><div class="post-nav"><a href="/2017/03/23/python字符串常用内置参数详解/" class="pre">python字符串常用内置参数详解</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://taoyak.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/zabbix/" style="font-size: 15px;">zabbix</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/28/python流程控制脚本/">python流程控制脚本</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/28/python冒泡排序/">python的冒泡排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/31/zabbix_agent类型所有的key/">zabbix agent 类型所有的key</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/31/zabbix_agentd.conf配置文件详解/">zabbix_agentd.conf配置文件详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/28/python字典简单介绍/">python字典简单介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/27/python列表简单介绍/">python列表简单介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/zabbix_server.conf配置文件详解/">zabbix_server.conf配置文件详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/python字符串常用内置参数详解/">python字符串常用内置参数详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/06/zabbix笔记之相关知识简单介绍/">zabbix监控软件相关知识简单介绍</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.djhull.com/" title="超哥" target="_blank">超哥</a><ul></ul><a href="https://lankors.github.io/" title="郑莹莹" target="_blank">郑莹莹</a><ul></ul><a href="http://mingmings.org/" title="宋明明" target="_blank">宋明明</a><ul></ul><a href="https://obeyconquer.github.io/" title="高洋" target="_blank">高洋</a><ul></ul><a href="https://dolinks.github.io/" title="张艺馨" target="_blank">张艺馨</a><ul></ul><a href="null" title="白乙兵" target="_blank">白乙兵</a><ul></ul><a href="https://www.heyyezi.com/" title="赵强" target="_blank">赵强</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Yak's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>